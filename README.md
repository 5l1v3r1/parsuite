# parsuite

Simple parser framework. This was written super fast because I'm super impatient when it comes to parsing stuff out of text files in various fomrats -- the whole purpose of this little tool.

# A Note on Usage

Almost all irrelevant output, such as `[+] Alerting on some event`, is printed to `stderr`. When an output file isn't desired, you can always clean up the output by sending `stderr` to the bitbucket and use `xclip` to catch the output from `stdout`, .e.g `python3.7 ./parsuite.py nmap_top_port_dumper -t 100 2>/dev/null | xclip -sel clip`.

# Usage

## Getting General Help

Below is the current help menu detailing functionality and modules.

```
[+] Starting the parser
[+] Loading modules
usage: parsuite.py [-h]
                   {enum4linux_dumper,masscan_xml_open_port_dumper,nessus_output_dumper,nmap_http_link_dumper,nmap_smb_security_mode_dumper,nmap_top_port_dumper,nmap_xml_service_dumper,recon_ng_contact_dumper,urlcrazy_to_csv}
                   ...

Parse the planet.

positional arguments:
  {masscan_xml_open_port_dumper,nessus_output_dumper,nmap_http_link_dumper,nmap_smb_security_mode_dumper,nmap_top_port_dumper,nmap_xml_service_dumper,recon_ng_contact_dumper,urlcrazy_to_csv}
                        Parser module selection.

    csharp_hexarray_parser
                        Parse C# shellcode from payload files generated by
                        Metsploit or Cobalt Strike. Useful when embedding
                        content in other formats.
    enum4linux_dumper   Dump groups and group memberships to disk, using the
                        filesystem as as basic database for simple searching
                        using grep and other mechanism.
    hash_linker         Link cracked hashes back with uncracked values.
    http_link_dumper    Parse either an NMAP or Nessus XML file (.nessus) and
                        dump http links relative to port and service. The
                        module will determine if the input file is Nessus or
                        NMAP by querying the document for a `policyName`
                        element, which indicates a Nessus file. All links are
                        printed to stdout.
    masscan_xml_open_port_dumper
                        Dump hosts and open ports from a masscan xml file.
    nessus_output_dumper
                        Parse a Nessus file and dump the contents to disk by:
                        risk_factor > plugin_name
    nmap_smb_security_mode_dumper
                        Dump hosts to a file containing the security mode
                        discovered by smb-security-mode.
    nmap_top_port_dumper
                        Parse the Nmap services file and dump the most
                        commonly open ports.
    nmap_xml_service_dumper
                        Accept a XML file generated by Nmap and write the
                        output to a local directory structure, organized by
                        service, for easy browsing.
    ntlm_hasher         NTLM hash a value.
    ntlmv2_dumper       Parse files containing NTLMv2 hashes in the common
                        format produced by Responder and Impacket and dump
                        them to stdout. Messages printed that are not hashes
                        are dumped to stderr. Use the -du flag to disable
                        uniquing of username/domain/password combinations.
    payload_inserter    Define an insertion point (signature) within a
                        template file and replace the line with a payload from
                        a distinct file. Useful in situations where an
                        extremely long payload needs to be inserted, such as
                        when working with hex shellcode for stageless
                        payloads.
    rdp_sec_check_dumper
                        Parse files containing NTLMv2 hashes in the commong
                        format produced by Responder and Impacket and dump
                        them to stdout. Messages printed that are not hashes
                        are dumped to stderr. Use the -du flag to disable
                        uniquing of username/domain combinations.
    recon_ng_contact_dumper
                        Parse an SQLite3 database generated by recon-ng and
                        dump the contacts out in simple string format
    socket_dumper       IPv4 ONLY! Accept a list of sockets and output three
                        files: unique list of IP addresses, unique list of
                        ports, unique list of fqdns
    urlcrazy_to_csv     Convert URLCrazy output to CSV
    xml_host_dumper     Dump hosts and open ports from multiple masscan, nmap,
                        or nessus files. A generalized abstraction layer is
                        used to produce objects that align with the Nmap XML
                        structure since it has the most comprehensive XSD
                        file.

optional arguments:
  -h, --help            show this help message and exit
```

## Getting Module Help

```
[+] Starting the parser
[+] Loading modules
usage: parsuite.py nessus_output_dumper [-h] --input-file INPUT_FILE
                                        --output-directory OUTPUT_DIRECTORY

optional arguments:
  -h, --help            show this help message and exit
  --input-file INPUT_FILE, -if INPUT_FILE
                        Input file to parse.
  --output-directory OUTPUT_DIRECTORY, -od OUTPUT_DIRECTORY
                        Output directory.
```

# Examples

## Parsing a Nessus File

The following command will parse a .nessus file and dump the contents to disk organized by risk_factor > plugin_name. A file called msf_modules will be included when a Metasploit module is available.

```
python3.6 parsuite.py nessus_output_dumper -if testfile.nessus -od test_output
[+] Output directory already exists!

Destroy and rebuild output? (destroy/no): destroy

[+] Checking /opt/git/parsuite/test_output/.tripfile before destroying...
[!] Destroying directory
[+] Creating new output directory: /opt/git/parsuite/test_output
Parsing: tcp:microsoft_windows_smb_nativelanmanager_remote_system_information_disclosure:445
Parsing: tcp:windows_netbios_smb_remote_host_information_disclosure:445
Parsing: tcp:dce_services_enumeration:49152
Parsing: tcp:dce_services_enumeration:52146
Parsing: tcp:dce_services_enumeration:49153
```
