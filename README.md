# parsuite

Simple parser framework. This was written super fast because I'm super impatient when it comes to parsing stuff out of text files in various fomrats -- the whole purpose of this little tool.

# A Note on Usage

Almost all irrelevant output, such as `[+] Alerting on some event`, is printed to `stderr`. When an output file isn't desired, you can always clean up the output by sending `stderr` to the bitbucket and use `xclip` to catch the output from `stdout`, .e.g `python3.7 ./parsuite.py nmap_top_port_dumper -t 100 2>/dev/null | xclip -sel clip`.

# Usage

## Getting General Help

```
[+] Starting the parser
[+] Loading modules
usage: parsuite.py [-h]
                   {enum4linux_dumper,masscan_xml_open_port_dumper,nessus_output_dumper,nmap_http_link_dumper,nmap_smb_security_mode_dumper,nmap_top_port_dumper,nmap_xml_service_dumper,recon_ng_contact_dumper,urlcrazy_to_csv}
                   ...

Parse the planet.

positional arguments:
  {masscan_xml_open_port_dumper,nessus_output_dumper,nmap_http_link_dumper,nmap_smb_security_mode_dumper,nmap_top_port_dumper,nmap_xml_service_dumper,recon_ng_contact_dumper,urlcrazy_to_csv}
                        Parser module selection.
    masscan_xml_open_port_dumper
                        Dump hosts and open ports from a masscan xml file.
    nessus_output_dumper
                        Parse a Nessus file and dump the contents to disk by:
                        risk_factor > plugin_name
    nmap_http_link_dumper
                        Parse ip addresses and hostnames from an nmap file and
                        return a series of links. It'll detect hostnames as
                        well to help with identifying virtual hosts.
    nmap_smb_security_mode_dumper
                        Dump hosts to a file containing the security mode
                        discovered by smb-security-mode.
    nmap_top_port_dumper
                        Parse the Nmap services file and dump the most
                        commonly open ports. However, note that more than the
                        x number of top ports may be returned. This is because
                        the services file uses frequency to determine which
                        ports are most commonly open, and a multiple ports can
                        have the same frequency.
    nmap_xml_service_dumper
                        Accept a XML file generated by Nmap and write the
                        output to a local directory structure, organized by
                        service, for easy browsing.
    recon_ng_contact_dumper
                        Parse an SQLite3 database generated by recon-ng and
                        dump the contacts out in simple string format
    urlcrazy_to_csv     Convert URLCrazy output to CSV

optional arguments:
  -h, --help            show this help message and exit
```

## Getting Module Help

```
[+] Starting the parser
[+] Loading modules
usage: parsuite.py nessus_output_dumper [-h] --input-file INPUT_FILE
                                        --output-directory OUTPUT_DIRECTORY

optional arguments:
  -h, --help            show this help message and exit
  --input-file INPUT_FILE, -if INPUT_FILE
                        Input file to parse.
  --output-directory OUTPUT_DIRECTORY, -od OUTPUT_DIRECTORY
                        Output directory.
```

# Examples

## Parsing a Nessus File

The following command will parse a .nessus file and dump the contents to disk organized by risk_factor > plugin_name. A file called msf_modules will be included when a Metasploit module is available.

```
python3.6 parsuite.py nessus_output_dumper -if testfile.nessus -od test_output
[+] Output directory already exists!

Destroy and rebuild output? (destroy/no): destroy

[+] Checking /opt/git/parsuite/test_output/.tripfile before destroying...
[!] Destroying directory
[+] Creating new output directory: /opt/git/parsuite/test_output
Parsing: tcp:microsoft_windows_smb_nativelanmanager_remote_system_information_disclosure:445
Parsing: tcp:windows_netbios_smb_remote_host_information_disclosure:445
Parsing: tcp:dce_services_enumeration:49152
Parsing: tcp:dce_services_enumeration:52146
Parsing: tcp:dce_services_enumeration:49153
```
